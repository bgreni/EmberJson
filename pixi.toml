[workspace]
authors = ["Brian Grenier <grenierb96@gmail.com>"]
channels = ["conda-forge", "https://conda.modular.com/max-nightly/"]
preview = ["pixi-build"]
description = "A json library for Mojo"
name = "emberjson"
platforms = ["osx-arm64", "linux-aarch64", "linux-64"]
version = "0.2.2"
license = "MIT"
license-file = "LICENSE"
homepage = "https://github.com/bgreni/EmberJson"
repository = "https://github.com/bgreni/EmberJson"

[tasks]
build = { cmd = "mojo package emberjson -o emberjson.mojopkg" }
format = { cmd = "mojo format -l 80 ." }
test = { cmd = "python run_tests.py" }
bench = { cmd = "mojo build bench.mojo && ./bench && rm bench" }
update_and_build = { cmd = "pixi update && pixi run test && pixi run build" }
precommit = { depends-on = ["format", "test", "test_python_compat", "fuzz"] }
update_and_test = "pixi update && pixi run test && pixi run bench"
test_python_compat = "python python_compat.py"

[dependencies]
mojo = ">=0.26.1.0.dev2025112705,<0.27"


[package]
name = "emberjson"
version = "0.2.2"

[package.build]
backend = { name = "pixi-build-mojo", version = "0.1.*" }

[package.host-dependencies]
mojo-compiler = ">=0.26.1.0.dev2025112105,<0.27"

[package.build-dependencies]
mojo-compiler = ">=0.26.1.0.dev2025112105,<0.27"

[package.run-dependencies]
mojo-compiler = ">=0.26.1.0.dev2025112105,<0.27"


[feature.fuzz.tasks]
fuzz = "mojo -D ASSERT=all --disable-warnings fuzz.mojo"

[feature.fuzz.dependencies]
faker = ">=36.1.1,<37"

[environments]
fuzz = { features = ["fuzz"], solve-group = "default" }
